---
layout: post
title: "about_Network"
description: "λ„¤νΈμ›ν¬μ— λ€ν•μ—¬"
categories: [network, ip, server, protocol]
tags: [network, server, ip, proxy, socket, protocol]
redirect_from:
  - /2024/03/27/
---

> λ„¤νΈμ›ν¬μ— λ€ν•μ—¬.

* Kramdown table of contents
{:toc .toc}

# <ins>JAVAμ—μ„ IP μ£Όμ† λ°ν™λ°›κΈ°</ins>
### IPμ μΆ…λ¥
>   
<a class="post-image" href="{{site.baseurl}}/assets/images/network/ip.png">
    <img itemprop="image" data-src="{{site.baseurl}}/assets/images/network/ip.png" src="{{site.baseurl}}/assets/javascripts/unveil/loader.gif" alt="μ™μ•λ– " />
</a>

> <b>[μμ„Έν μ•μ•„λ³΄κΈ°]</b>
- Wifiμ— μ—°κ²°μ΄ λμ—λ‹¤λ©΄ Public IP, Private IP μ¤‘ μ–΄λ–¤ IPλ¥Ό λ°κΈ‰ λ°›μ„κΉ?  
π’΅WifiλΌλ” μ‚¬μ„¤ IP λ‚΄μ—μ„ κ³ μ ν• IP κ°’μ„ λ°κΈ‰λ°›κΈ° λ•λ¬Έμ— Wifi λ‚΄μ—μ„λ” Private IP κ°’μ„ λ°κΈ‰ λ°›λ”λ‹¤. κ·Έλ¬λ‚ μΈν„°λ„·μ„ μ ‘κ·Όν•  λ•λ” β€μΈν„°λ„· μ„λΉ„μ¤ μ κ³µμ(ISP)β€™μ— μν•΄ λ°κΈ‰λ°›μ€ κ³ μ ν• Public IP κ°’μ„ μ΄μ©ν•λ‹¤.  
- κ²€μƒ‰ ν¬ν„Έ μ‚¬μ΄νΈμ—μ„ β€λ‚΄ μ•„μ΄ν”Ό μ£Όμ†β€™λΌκ³  κ²€μƒ‰μ„ ν•λ©΄ λ‚μ¤λ” κ°’μ€ λ¬΄μ¨ IPλ¥Ό μλ―Έν• κΉ?  
π’΅μ‚¬μ©μκ°€ λ„¤νΈμ›ν¬μ— μΈν„°λ„· μ—°κ²°λ  λ• β€μΈν„°λ„· μ„λΉ„μ¤ μ κ³µμ(ISP)β€™μ— μν•΄ ν• λ‹Ήλλ” μ£Όμ†λ΅, μ™Έλ¶€/κ³µκ° IP(Public IP)λ¥Ό μλ―Έν•λ‹¤.  
- κ·Έλ¬λ©΄ λ‚΄κ°€ μ ‘κ·Όν•λ” ν¬ν„Έλ§λ‹¤ Public IPκ°€ λ‹¬λΌμ§€λ” κ²ƒμΌκΉ?  
π’΅μ‚¬μ©μκ°€ μΈν„°λ„·μ— μ ‘μ†ν•  λ• ν• λ‹Ήλ°›λ” κ³µκ° IP μ£Όμ†λ” μΈν„°λ„· μ„λΉ„μ¤ μ κ³µμ(ISP)μ—μ„ μ κ³µν•λ” κ²ƒμ΄λ―€λ΅, ν¬ν„Έ μ‚¬μ΄νΈλ¥Ό λ³€κ²½ν•λ”λΌλ„ κ³µκ° IP μ£Όμ†λ” λ™μΌν•κ² μ μ§€λλ‹¤.  
- Public IPκ°€ λ³€κ²½λμ§€ μ•μΌλ©΄ κ³ μ •λλ” κ°’μΌκΉ?  
π’΅Public IP μ£Όμ†λ” μ—¬λ¬ μƒν™©μ—μ„ λ³€κ²½λ  μ μλ‹¤. μΈν„°λ„· μ„λΉ„μ¤ μ κ³µμ(ISP)κ°€ IP μ£Όμ†λ¥Ό λ™μ μΌλ΅ ν• λ‹Ήν•λ” κ²½μ°, λΌμ°ν„°λ‚ λ¨λ€μ„ μ¬μ‹μ‘ν•κ±°λ‚ μΌμ • μ‹κ°„ λ™μ• μΈν„°λ„· μ—°κ²°μ΄ λμ–΄μ§„ ν›„μ—λ” μƒλ΅μ΄ IP μ£Όμ†κ°€ ν• λ‹Ήλ  μ μλ‹¤. λν•, ISPκ°€ IP μ£Όμ†λ¥Ό λ³€κ²½ν•κ±°λ‚ μ‚¬μ©μκ°€ VPN κ°™μ€ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ IP μ£Όμ†λ¥Ό λ³€κ²½ν•λ” κ²½μ°μ—λ„ κ³µκ° IP μ£Όμ†λ” λ‹¬λΌμ§ μ μλ‹¤.

### Client IP Address
> - μΈν„°λ„·μ„ μ‚¬μ©ν•λ” μ¥μΉ(μ: μ»΄ν“¨ν„°, μ¤λ§νΈν° λ“±)κ°€ μΈν„°λ„·μ— μ—°κ²°λ  λ•, ν• λ‹Ήλ°›λ” κ³ μ ν• μ£Όμ†.  
μ΄ μ£Όμ†λ” μΈν„°λ„·μƒμ ν†µμ‹ μ—μ„ ν•΄λ‹Ή μ¥μΉλ¥Ό μ‹λ³„ν•λ” μ—­ν• μ„ ν•λ‹¤.
- μ°Έκ³  μμ‹) μ΄μ „μκ²© CmmnAbstractServiceImpl.java

~~~~java  
import org.springframework.web.context.request.RequestContextHolder;  
import org.springframework.web.context.request.ServletRequestAttributes;  
import javax.servlet.http.HttpServletRequest;  

public class Main {
    public static void main(String[] args) {
        String clientIp = "";
        HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()).getRequest();
        clientIp = request.getHeader("X-Forwarded-For");

        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("Proxy-Client-IP");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("WL-Proxy-Client-IP");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("HTTP_CLIENT_IP");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("HTTP_X_FORWARDED_FOR");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("X-Real-IP");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("X-RealIP");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getHeader("REMOTE_ADDR");
        }
        if (clientIp == null || clientIp.length() == 0 || "unknown".equalsIgnoreCase(clientIp)) {
            clientIp = request.getRemoteAddr();
        }
        System.out.println("Client IP - " + clientIp);
    }
}
~~~~
> κ²°κ³Όλ” λ‚΄ PCμ— μ ‘κ·Όν•κΈ° λ•λ¬Έμ—, Ipv6ν•νƒμΈ "Client IP - 0:0:0:0:0:0:0:1"μΌλ΅ λ°ν™μ„ λ°›λ”λ‹¤.

### Host IP Address
> - ν„μ¬ μ»΄ν“¨ν„° μ‹μ¤ν…μ΄ μ—°κ²°λ λ„¤νΈμ›ν¬ IP μ£Όμ†. μ΄ μ£Όμ†λ” "InetAddress.getLocalHost().getHostAddress()" ν•¨μλ¥Ό μ‚¬μ©ν•μ—¬ μ–»μ„ μ μλ‹¤.  
λ°ν™λλ” IP μ£Όμ†λ” λ‚΄λ¶€ λ„¤νΈμ›ν¬μ <u>Private IP μ£Όμ†μΌ μλ„ μκ³ </u>, μ™Έλ¶€ λ„¤νΈμ›ν¬λ΅λ¶€ν„° ν• λ‹Ήλ°›μ€ <u>Public IP μ£Όμ†μΌ μλ„ μλ‹¤</u>.
- μ‹μ¤ν…μ΄ λ‚΄λ¶€ λ„¤νΈμ›ν¬μ—λ§ μ—°κ²°λμ–΄ μλ‹¤λ©΄, μ΄ ν•¨μλ” Private IPλ¥Ό λ°ν™ν•λ‹¤. ν•μ§€λ§ μΈν„°λ„·μ— μ—°κ²°λμ–΄ μλ‹¤λ©΄, Public IPλ¥Ό λ°ν™ν•λ‹¤.

~~~java
import java.net.InetAddress;
import java.net.UnknownHostException;

public class Main {
    public static void main(String[] args) {
        String localhostIp = "";
       try {
            String hostAddr = InetAddress.getLocalHost().getHostAddress();
            System.out.println("Host IP Address: " + hostAddr);
        } catch (UnknownHostException e) {
            log.error("Exception :: " + e.getMessage());
        }
    }
}
~~~

### Public IP Address
> - μΈν„°λ„·μ— μ—°κ²°λ μ¥μΉκ°€ μ™Έλ¶€ μ„Έκ³„μ™€ ν†µμ‹ ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μ£Όμ†. μ΄ μ£Όμ†λ” μΈν„°λ„· μ„λΉ„μ¤ μ κ³µμ—…μ²΄(ISP)μ— μν•΄ ν• λ‹Ήλλ©°, μΈν„°λ„·μƒμ λ‹¤λ¥Έ μ¥μΉλ¥Ό μ°Ύκ³  ν†µμ‹ ν•  μ μλ„λ΅ ν•΄μ¤€λ‹¤.

### Private IP Address
> - μ‚¬μ„¤ λ„¤νΈμ›ν¬(μ: μ§‘μ΄λ‚ μ‚¬λ¬΄μ‹¤μ Wi-Fi λ„¤νΈμ›ν¬)μ—μ„ μ‚¬μ©λλ” μ£Όμ†. μ΄ μ£Όμ†λ” κ³µμ κΈ° λλ” λ„¤νΈμ›ν¬ κ΄€λ¦¬μμ— μν•΄ ν• λ‹Ήλλ©°, κ°™μ€ μ‚¬μ„¤ λ„¤νΈμ›ν¬ λ‚΄μ λ‹¤λ¥Έ μ¥μΉλ“¤μ΄ μ¥μΉλ¥Ό μ°Ύκ³  ν†µμ‹ ν•  μ μλ„λ΅ ν•΄μ¤€λ‹¤.

~~~java
import java.net.InetAddress;
import java.net.NetworkInterface;
import java.util.Enumeration;

public class Main {
  public static void main(String[] args) {
    try {
      Enumeration<NetworkInterface> networkInterfaces = NetworkInterface.getNetworkInterfaces();
      while (networkInterfaces.hasMoreElements()) {
        NetworkInterface networkInterface = networkInterfaces.nextElement();
        Enumeration<InetAddress> inetAddresses = networkInterface.getInetAddresses();
        while (inetAddresses.hasMoreElements()) {
          InetAddress inetAddress = inetAddresses.nextElement();
          if (inetAddress.isSiteLocalAddress()) {
            System.out.println("λ‚΄λ¶€ IP μ£Όμ†: " + inetAddress.getHostAddress());
          }
        }
      }
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
~~~
> - μ‚¬μ„¤ λ„¤νΈμ›ν¬λ” μ™ μ—¬λ¬ κ°κ°€ λ‚μ¬ μ μλ”κ°€?  
π’΅ν• λ€μ μ»΄ν“¨ν„°μ—λ” μ—¬λ¬ κ°μ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤(μ: μ μ„  λ„¤νΈμ›ν¬, λ¬΄μ„  λ„¤νΈμ›ν¬ μΉ΄λ“, κ°€μƒ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤ λ“±)κ°€ μ΅΄μ¬ν•  μ μκ³ , κ° λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤κ°€ κ°κ°μ λ‚΄λ¶€ IP μ£Όμ†λ¥Ό κ°€μ§€κ³  μκΈ° λ•λ¬Έμ— λ‚΄λ¶€ IP μ£Όμ†κ°€ μ—¬λ¬ κ°μΌ μ μλ‹¤.